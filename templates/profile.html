<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Alumni Profile | NSUT</title>
    <link rel="stylesheet" href="static/profile.css" />
  </head>
  <body>
    <!-- HEADER -->
    <header>
      <div class="logo">
        <img src="static/nsut.logo.png" alt="NSUT Logo" />
      </div>
      <nav>
        <ul>
          <li><a href="/home">Home</a></li>
          <li><a href="/profile" class="active">Profile</a></li>
          <li><a href="/directory">Alumni Directory</a></li>
          <li><a href="/academic_history">Academic History</a></li>
          <li><a href="/notices">Notices / Events</a></li>
          <li><a href="/donation">Donations</a></li>
        </ul>
      </nav>
      <form action="/logout" method="POST" style="display:inline;"><button class="logout-btn">Logout</button></form>
    </header>

    <!-- MAIN CONTENT -->
    <main>
      <!-- Profile Overview -->
      <section class="profile-overview">
        <div class="profile-pic">
          <img src="/static/profile-placeholder.jpg" alt="Profile Picture" />
        </div>
        <div class="profile-info">
	<h2>{{.alumnus.Name}}</h2>
	<p><strong>Roll Number: {{.alumnus.Roll_no}}</strong></p>
	<p><strong>Department: {{.alumnus.Department}}</strong></p>
	<p><strong>Batch: {{.alumnus.Batch}}</strong></p>
	<p><strong>Email: {{.alumnus.Email}}</strong></p>
	<p><strong>Phone: {{.alumnus.Phone_no}}</strong></p>
        </div>
      </section>
      <!-- Professional Details -->
<section class="section-card">
  <div class="section-header">
    <h3>Professional Details</h3>
    <button type="button" id="addBtn" class="add-btn">+ Add</button>
  </div>

  <!-- Example existing entries -->
  <div class="company-entry" data-id="1">
					{{range .employments}}
    <ul>
	<li><strong>Company:</strong>{{.Company}}</li>
	<li><strong>Start Year:</strong>{{.Starting}}</li>
	<li><strong>End Year:</strong>{{.Ending}}</li>
	<li><strong>Designation:</strong>{{.Designation}}</li>
	<li><strong>Location:</strong>{{.Location}}</li>
    </ul>
    <div class="actions">
      <button type="button" class="edit-btn" data-id="1">Edit</button>
      <form action="/delete_employment" method="POST" class="delete-form" style="display:inline;">
	<input type="hidden" name="id" value="{{.Id}}">
        <button type="submit" class="delete-btn">Delete</button>
      </form>
						{{end}}
    </div>
    <hr>
  </div>
</section>

     </main>
<!-- Modal -->
<div id="editModal" class="modal" style="display:none;">
  <div class="modal-content">
    <span id="closeModal" class="close">&times;</span>
    <h3 id="modalTitle">Edit Professional Details</h3>
    <form id="editForm" method="POST" action="/save_employment">
      <input type="hidden" id="editId" name="id" />

      <label for="editCompany">Company:</label>
      <input type="text" id="editCompany" name="company" required />

      <label for="editStartYear">Starting Year:</label>
      <select id="editStartYear" name="startYear" required></select>

      <label for="editEndYear">Ending Year:</label>
      <select id="editEndYear" name="endYear" required></select>

      <label for="editDesignation">Designation:</label>
      <input type="text" id="editDesignation" name="designation" required />

      <label for="editLocation">Location:</label>
      <input type="text" id="editLocation" name="location" />

      <button type="submit" id="saveBtn">Save</button>
      <button type="button" id="cancelBtn">Cancel</button>
    </form>
  </div>
</div>
    <!-- FOOTER -->
    <footer>
      <p>&copy; 2025 NSUT Alumni Portal | All Rights Reserved</p>
      <div class="footer-links">
        <a href="#">Privacy Policy</a> | <a href="#">Terms of Use</a> |
        <a href="#">Contact</a>
      </div>
    </footer>

    <!-- SCRIPT -->
<script>
const modal = document.getElementById('editModal');
const closeModal = document.getElementById('closeModal');
const cancelBtn = document.getElementById('cancelBtn');
const addBtn = document.getElementById('addBtn');
const modalTitle = document.getElementById('modalTitle');
const startYearSelect = document.getElementById('editStartYear');
const endYearSelect = document.getElementById('editEndYear');

// Populate dropdowns dynamically
const currentYear = new Date().getFullYear();
for (let year = currentYear; year >= 1980; year--) {
  const opt1 = document.createElement('option');
  opt1.value = opt1.textContent = year;
  startYearSelect.appendChild(opt1);

  const opt2 = document.createElement('option');
  opt2.value = opt2.textContent = year;
  endYearSelect.appendChild(opt2);
}

// Function to open modal
function openModal(isEdit = false, data = {}) {
  modal.style.display = 'flex';
  document.getElementById('editId').value = data.id || '';
  document.getElementById('editCompany').value = data.company || '';
  document.getElementById('editDesignation').value = data.designation || '';
  document.getElementById('editLocation').value = data.location || '';
  document.getElementById('editStartYear').value = data.startYear || '';
  document.getElementById('editEndYear').value = data.endYear || '';
  modalTitle.textContent = isEdit ? 'Edit Professional Details' : 'Add Professional Details';
}

// Open modal for Add
addBtn.addEventListener('click', () => openModal(false));

// Open modal for Edit
document.querySelectorAll('.edit-btn').forEach(button => {
  button.addEventListener('click', e => {
    const entry = e.target.closest('.company-entry');
    const items = entry.querySelectorAll('ul li');
    const data = {
      id: entry.dataset.id,
      company: items[0].textContent.replace('Company:', '').trim(),
      startYear: items[1].textContent.replace('Start Year:', '').trim(),
      endYear: items[2].textContent.replace('End Year:', '').trim(),
      designation: items[3].textContent.replace('Designation:', '').trim(),
      location: items[4].textContent.replace('Location:', '').trim()
};
    openModal(true, data);
  });
});

// Delete confirmation
document.querySelectorAll('.delete-form').forEach(form => {
  form.addEventListener('submit', e => {
    if (!confirm('Are you sure you want to delete this record?')) {
      e.preventDefault();
    }
  });
});

// Close modal logic
closeModal.onclick = () => (modal.style.display = 'none');
cancelBtn.onclick = () => (modal.style.display = 'none');
window.onclick = event => {
  if (event.target === modal) modal.style.display = 'none';
};
</script>
  </body>
</html>
